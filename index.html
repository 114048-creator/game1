<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8">
    <title>Untitled</title>
    

  </head>
    
  <body>
  <!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>超級瑪利歐迷你版 - 立即玩</title>
    <style>
        body { margin: 0; overflow: hidden; background: #5c94fc; font-family: Arial, sans-serif; }
        canvas { display: block; background: #5c94fc; margin: 20px auto; border: 4px solid #000; box-shadow: 0 0 20px rgba(0,0,0,0.5); }
        .ui { position: absolute; top: 10px; left: 10px; color: white; text-shadow: 2px 2px #000; }
    </style>
</head>
<body>
    <div class="ui">
        <h1>超級瑪利歐：迷你模式</h1>
        <p>控制：方向鍵移動 & 跳躍 (↑) | 目標：抵達右側金色區域</p>
    </div>
    <canvas id="gameCanvas"></canvas>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

canvas.width = 800;
canvas.height = 400;

// 遊戲設定
const gravity = 0.8;
const friction = 0.8;

const player = {
    x: 50,
    y: 300,
    width: 32,
    height: 32,
    speed: 5,
    velX: 0,
    velY: 0,
    jumping: false,
    color: "#ff0000" // 瑪利歐紅
};

// 地圖佈局 (x, y, width, height, color)
const platforms = [
    { x: 0, y: 380, w: 1000, h: 20, color: "#884010" }, // 地面
    { x: 200, y: 280, w: 100, h: 20, color: "#ffcc00" }, // 漂浮平台 1
    { x: 400, y: 200, w: 100, h: 20, color: "#ffcc00" }, // 漂浮平台 2
    { x: 600, y: 280, w: 100, h: 20, color: "#ffcc00" }, // 漂浮平台 3
    { x: 750, y: 100, w: 50, h: 300, color: "#ffd700" }  // 終點金柱
];

const keys = {};

// 監聽按鍵
window.addEventListener('keydown', e => { keys[e.code] = true; });
window.addEventListener('keyup', e => { keys[e.code] = false; });

function update() {
    // 左右移動控制
    if (keys['ArrowRight'] || keys['KeyD']) {
        if (player.velX < player.speed) player.velX++;
    }
    if (keys['ArrowLeft'] || keys['KeyA']) {
        if (player.velX > -player.speed) player.velX--;
    }
    
    // 跳躍控制
    if ((keys['ArrowUp'] || keys['KeyW'] || keys['Space']) && !player.jumping) {
        player.velY = -15;
        player.jumping = true;
    }

    // 物理：摩擦力與重力
    player.velX *= friction;
    player.velY += gravity;

    // 更新位置
    player.x += player.velX;
    player.y += player.velY;

    // 碰撞檢測 (簡單平台碰撞)
    let onGround = false;
    for (let plat of platforms) {
        if (player.x < plat.x + plat.w &&
            player.x + player.width > plat.x &&
            player.y < plat.y + plat.h &&
            player.y + player.height > plat.y) {
            
            // 從上方落下的碰撞
            if (player.velY > 0 && player.y + player.height - player.velY <= plat.y) {
                player.jumping = false;
                player.velY = 0;
                player.y = plat.y - player.height;
                onGround = true;
                
                // 勝利判斷 (碰到金柱)
                if(plat.color === "#ffd700") {
                    alert("恭喜破關！瑪利歐救到了公主（大概）！");
                    resetGame();
                }
            }
        }
    }

    // 邊界限制
    if (player.x < 0) player.x = 0;
    if (player.x + player.width > canvas.width) player.x = canvas.width - player.width;
    
    // 掉落虛空重置
    if (player.y > canvas.height) {
        resetGame();
    }

    draw();
    requestAnimationFrame(update);
}

function resetGame() {
    player.x = 50;
    player.y = 300;
    player.velX = 0;
    player.velY = 0;
}

function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // 畫背景裝飾（簡單的雲）
    ctx.fillStyle = "white";
    ctx.beginPath();
    ctx.arc(100, 100, 30, 0, Math.PI * 2);
    ctx.arc(130, 100, 40, 0, Math.PI * 2);
    ctx.arc(160, 100, 30, 0, Math.PI * 2);
    ctx.fill();

    // 畫平台
    for (let plat of platforms) {
        ctx.fillStyle = plat.color;
        ctx.fillRect(plat.x, plat.y, plat.w, plat.h);
        // 加上邊框感
        ctx.strokeStyle = "#000";
        ctx.strokeRect(plat.x, plat.y, plat.w, plat.h);
    }

    // 畫瑪利歐 (主角)
    ctx.fillStyle = player.color;
    ctx.fillRect(player.x, player.y, player.width, player.height);
    
    // 畫眼睛（增加生動感）
    ctx.fillStyle = "black";
    ctx.fillRect(player.x + 20, player.y + 5, 5, 10);
}

// 啟動遊戲
update();
</script>
</body>
</html>
    
  </body>
  
</html>
